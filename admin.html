<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>âš™ï¸ Admin - One Piece Bounty System</title>
  <link rel="stylesheet" href="css/admin.css">
</head>
<body>
  <div class="admin-container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <h2>âš“ ADMIN</h2>
        <p>One Piece System</p>
      </div>
      <nav class="sidebar-nav">
        <button class="nav-item active" data-tab="pirates">
          <span class="nav-icon">ğŸ´â€â˜ ï¸</span>
          <span class="nav-text">Quáº£n lÃ½ Háº£i Táº·c</span>
        </button>
        <button class="nav-item" data-tab="crews">
          <span class="nav-icon">âš”ï¸</span>
          <span class="nav-text">Quáº£n lÃ½ BÄƒng NhÃ³m</span>
        </button>
        <button class="nav-item" data-tab="ranks">
          <span class="nav-icon">ğŸ†</span>
          <span class="nav-text">Quáº£n lÃ½ Cáº¥p Äá»™</span>
        </button>
        <button class="nav-item" data-tab="accounts">
          <span class="nav-icon">ğŸ‘¥</span>
          <span class="nav-text">Quáº£n lÃ½ TÃ i Khoáº£n</span>
        </button>
      </nav>
      <div class="sidebar-footer">
        <a href="index.html" class="back-btn">
          <span>ğŸ”™</span> Quay láº¡i trang chÃ­nh
        </a>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Header -->
      <header class="admin-header">
        <h1 id="pageTitle">ğŸ´â€â˜ ï¸ Quáº£n lÃ½ Háº£i Táº·c</h1>
        <div class="header-actions">
          <button class="action-btn export" onclick="exportData()">
            <span>ğŸ“¤</span> Xuáº¥t dá»¯ liá»‡u
          </button>
          <button class="action-btn import" onclick="document.getElementById('importFile').click()">
            <span>ğŸ“¥</span> Nháº­p dá»¯ liá»‡u
          </button>
          <button class="action-btn sync" onclick="syncToCloud()" title="Äá»“ng bá»™ lÃªn Firebase">
            <span>â˜ï¸</span> Sync Cloud
          </button>
          <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importData(event)">
        </div>
      </header>

      <!-- Tab Content: Pirates -->
      <section id="pirates-tab" class="tab-content active">
        <div class="tab-header">
          <div class="search-box">
            <input type="text" id="pirateSearch" placeholder="ğŸ” TÃ¬m kiáº¿m háº£i táº·c..." oninput="searchPirates(this.value)">
          </div>
          <button class="add-btn" onclick="openAddPirateModal()">
            <span>â•</span> ThÃªm Háº£i Táº·c
          </button>
        </div>
        <div class="stats-row">
          <div class="stat-card">
            <span class="stat-icon">ğŸ´â€â˜ ï¸</span>
            <div class="stat-info">
              <span class="stat-value" id="totalPirates">0</span>
              <span class="stat-label">Tá»•ng Háº£i Táº·c</span>
            </div>
          </div>
          <div class="stat-card">
            <span class="stat-icon">ğŸ’°</span>
            <div class="stat-info">
              <span class="stat-value" id="totalBounty">0à¸¿</span>
              <span class="stat-label">Tá»•ng Bounty</span>
            </div>
          </div>
          <div class="stat-card">
            <span class="stat-icon">ğŸ‘‘</span>
            <div class="stat-info">
              <span class="stat-value" id="topRank">-</span>
              <span class="stat-label">Cáº¥p Cao Nháº¥t</span>
            </div>
          </div>
        </div>
        <div class="table-container">
          <table class="data-table" id="piratesTable">
            <thead>
              <tr>
                <th>STT</th>
                <th>Avatar</th>
                <th>TÃªn</th>
                <th>BÄƒng NhÃ³m</th>
                <th>Bounty</th>
                <th>Cáº¥p Äá»™</th>
                <th>Thao tÃ¡c</th>
              </tr>
            </thead>
            <tbody id="piratesTableBody">
              <!-- Data will be loaded here -->
            </tbody>
          </table>
        </div>
      </section>

      <!-- Tab Content: Crews -->
      <section id="crews-tab" class="tab-content">
        <div class="tab-header">
          <div class="search-box">
            <input type="text" id="crewSearch" placeholder="ğŸ” TÃ¬m kiáº¿m bÄƒng nhÃ³m..." oninput="searchCrews(this.value)">
          </div>
          <button class="add-btn" onclick="openAddCrewModal()">
            <span>â•</span> ThÃªm BÄƒng NhÃ³m
          </button>
        </div>
        <div class="stats-row">
          <div class="stat-card">
            <span class="stat-icon">âš”ï¸</span>
            <div class="stat-info">
              <span class="stat-value" id="totalCrews">0</span>
              <span class="stat-label">Tá»•ng BÄƒng NhÃ³m</span>
            </div>
          </div>
          <div class="stat-card">
            <span class="stat-icon">ğŸ‘¥</span>
            <div class="stat-info">
              <span class="stat-value" id="avgMembers">0</span>
              <span class="stat-label">TB ThÃ nh ViÃªn</span>
            </div>
          </div>
        </div>
        <div class="crews-grid" id="crewsGrid">
          <!-- Crews will be loaded here -->
        </div>
      </section>

      <!-- Tab Content: Ranks -->
      <section id="ranks-tab" class="tab-content">
        <div class="tab-header">
          <h3>âš™ï¸ Cáº¥u hÃ¬nh cÃ¡c cáº¥p Ä‘á»™ bounty</h3>
          <button class="add-btn" onclick="openAddRankModal()">
            <span>â•</span> ThÃªm Cáº¥p Äá»™
          </button>
        </div>
        <div class="ranks-list" id="ranksList">
          <!-- Ranks will be loaded here -->
        </div>
      </section>

      <!-- Tab Content: Accounts -->
      <section id="accounts-tab" class="tab-content">
        <div class="tab-header">
          <div class="search-box">
            <input type="text" id="accountSearch" placeholder="ğŸ” TÃ¬m kiáº¿m tÃ i khoáº£n..." oninput="searchAccounts(this.value)">
          </div>
          <button class="add-btn" onclick="openAddAccountModal()">
            <span>â•</span> ThÃªm TÃ i Khoáº£n
          </button>
        </div>
        <div class="stats-row">
          <div class="stat-card">
            <span class="stat-icon">ğŸ‘¥</span>
            <div class="stat-info">
              <span class="stat-value" id="totalAccounts">0</span>
              <span class="stat-label">Tá»•ng TÃ i Khoáº£n</span>
            </div>
          </div>
          <div class="stat-card">
            <span class="stat-icon">ğŸ‘‘</span>
            <div class="stat-info">
              <span class="stat-value" id="adminAccounts">0</span>
              <span class="stat-label">Admin</span>
            </div>
          </div>
          <div class="stat-card">
            <span class="stat-icon">ğŸ‘¤</span>
            <div class="stat-info">
              <span class="stat-value" id="userAccounts">0</span>
              <span class="stat-label">User</span>
            </div>
          </div>
        </div>
        <div class="table-container">
          <table class="data-table" id="accountsTable">
            <thead>
              <tr>
                <th>STT</th>
                <th>Username</th>
                <th>Email</th>
                <th>ğŸ´â€â˜ ï¸ Háº£i Táº·c</th>
                <th>Vai trÃ²</th>
                <th>Tráº¡ng thÃ¡i</th>
                <th>NgÃ y táº¡o</th>
                <th>Thao tÃ¡c</th>
              </tr>
            </thead>
            <tbody id="accountsTableBody">
              <!-- Data will be loaded here -->
            </tbody>
          </table>
        </div>
      </section>
    </main>
  </div>

  <!-- Modal: Add/Edit Pirate -->
  <div class="modal-overlay" id="pirateModal">
    <div class="modal">
      <div class="modal-header">
        <h3 id="pirateModalTitle">â• ThÃªm Háº£i Táº·c</h3>
        <button class="close-btn" onclick="closeModal('pirateModal')">&times;</button>
      </div>
      <div class="modal-body">
        <form id="pirateForm" onsubmit="savePirate(event)">
          <input type="hidden" id="pirateIndex" value="-1">
          <div class="form-group">
            <label>ğŸ´â€â˜ ï¸ TÃªn Háº£i Táº·c</label>
            <input type="text" id="pirateName" required placeholder="Nháº­p tÃªn háº£i táº·c...">
          </div>
          <div class="form-group">
            <label>âš”ï¸ BÄƒng NhÃ³m</label>
            <select id="pirateCrew" required>
              <!-- Options will be loaded -->
            </select>
          </div>
          <div class="form-group">
            <label>ğŸ’° Bounty</label>
            <input type="number" id="pirateBounty" required min="0" placeholder="Nháº­p sá»‘ tiá»n truy nÃ£...">
          </div>
          <div class="form-group">
            <label>ğŸ–¼ï¸ Avatar (URL hoáº·c Base64)</label>
            <input type="text" id="pirateImage" placeholder="URL áº£nh hoáº·c Ä‘á»ƒ trá»‘ng...">
          </div>
          <div class="form-actions">
            <button type="button" class="btn-cancel" onclick="closeModal('pirateModal')">Há»§y</button>
            <button type="submit" class="btn-save">LÆ°u</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Modal: Add/Edit Crew -->
  <div class="modal-overlay" id="crewModal">
    <div class="modal">
      <div class="modal-header">
        <h3 id="crewModalTitle">â• ThÃªm BÄƒng NhÃ³m</h3>
        <button class="close-btn" onclick="closeModal('crewModal')">&times;</button>
      </div>
      <div class="modal-body">
        <form id="crewForm" onsubmit="saveCrew(event)">
          <input type="hidden" id="crewIndex" value="-1">
          <div class="form-group">
            <label>âš”ï¸ TÃªn BÄƒng NhÃ³m</label>
            <input type="text" id="crewName" required placeholder="Nháº­p tÃªn bÄƒng nhÃ³m...">
          </div>
          <div class="form-group">
            <label>ğŸ¨ Icon</label>
            <input type="text" id="crewIcon" required placeholder="Emoji icon (vÃ­ dá»¥: ğŸ´â€â˜ ï¸)">
          </div>
          <div class="form-group">
            <label>ğŸ¨ MÃ u sáº¯c</label>
            <input type="color" id="crewColor" value="#e74c3c">
          </div>
          <div class="form-group">
            <label>ğŸ‘‘ Thuyá»n TrÆ°á»Ÿng</label>
            <input type="text" id="crewCaptain" required placeholder="TÃªn thuyá»n trÆ°á»Ÿng...">
          </div>
          <div class="form-actions">
            <button type="button" class="btn-cancel" onclick="closeModal('crewModal')">Há»§y</button>
            <button type="submit" class="btn-save">LÆ°u</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Modal: Add/Edit Rank -->
  <div class="modal-overlay" id="rankModal">
    <div class="modal">
      <div class="modal-header">
        <h3 id="rankModalTitle">â• ThÃªm Cáº¥p Äá»™</h3>
        <button class="close-btn" onclick="closeModal('rankModal')">&times;</button>
      </div>
      <div class="modal-body">
        <form id="rankForm" onsubmit="saveRank(event)">
          <input type="hidden" id="rankIndex" value="-1">
          <div class="form-group">
            <label>ğŸ·ï¸ Type (ID)</label>
            <input type="text" id="rankType" required placeholder="rookie, pirate, supernova...">
          </div>
          <div class="form-group">
            <label>ğŸ“› TÃªn Hiá»ƒn Thá»‹</label>
            <input type="text" id="rankName" required placeholder="TÃ¢n Binh, Háº£i Táº·c...">
          </div>
          <div class="form-group">
            <label>ğŸ¨ Icon</label>
            <input type="text" id="rankIcon" required placeholder="ğŸ‘¶, ğŸ´â€â˜ ï¸, â­...">
          </div>
          <div class="form-group">
            <label>ğŸ¨ MÃ u sáº¯c</label>
            <input type="color" id="rankColor" value="#95a5a6">
          </div>
          <div class="form-group">
            <label>ğŸ’° Bounty Tá»‘i Thiá»ƒu</label>
            <input type="number" id="rankMinBounty" required min="0" placeholder="0, 80, 180...">
          </div>
          <div class="form-actions">
            <button type="button" class="btn-cancel" onclick="closeModal('rankModal')">Há»§y</button>
            <button type="submit" class="btn-save">LÆ°u</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Modal: Add/Edit Account -->
  <div class="modal-overlay" id="accountModal">
    <div class="modal">
      <div class="modal-header">
        <h3 id="accountModalTitle">â• ThÃªm TÃ i Khoáº£n</h3>
        <button class="close-btn" onclick="closeModal('accountModal')">&times;</button>
      </div>
      <div class="modal-body">
        <form id="accountForm" onsubmit="saveAccount(event)">
          <input type="hidden" id="accountIndex" value="-1">
          <div class="form-group">
            <label>ğŸ‘¤ Username</label>
            <input type="text" id="accountUsername" required placeholder="Nháº­p username...">
          </div>
          <div class="form-group">
            <label>ğŸ“§ Email</label>
            <input type="email" id="accountEmail" required placeholder="Nháº­p email...">
          </div>
          <div class="form-group">
            <label>ğŸ”’ Máº­t kháº©u</label>
            <input type="password" id="accountPassword" placeholder="Nháº­p máº­t kháº©u...">
          </div>
          <div class="form-group">
            <label>ğŸ´â€â˜ ï¸ Háº£i Táº·c LiÃªn Káº¿t</label>
            <select id="accountPirate">
              <option value="">-- KhÃ´ng liÃªn káº¿t --</option>
              <!-- Options will be loaded -->
            </select>
          </div>
          <div class="form-group">
            <label>ğŸ‘‘ Vai trÃ²</label>
            <select id="accountRole" required>
              <option value="user">User</option>
              <option value="moderator">Moderator</option>
              <option value="admin">Admin</option>
            </select>
          </div>
          <div class="form-group">
            <label>ğŸ“Š Tráº¡ng thÃ¡i</label>
            <select id="accountStatus" required>
              <option value="active">Hoáº¡t Ä‘á»™ng</option>
              <option value="inactive">KhÃ´ng hoáº¡t Ä‘á»™ng</option>
              <option value="banned">Bá»‹ cáº¥m</option>
            </select>
          </div>
          <div class="form-actions">
            <button type="button" class="btn-cancel" onclick="closeModal('accountModal')">Há»§y</button>
            <button type="submit" class="btn-save">LÆ°u</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Confirm Modal -->
  <div class="modal-overlay" id="confirmModal">
    <div class="modal modal-sm">
      <div class="modal-header">
        <h3>âš ï¸ XÃ¡c nháº­n</h3>
        <button class="close-btn" onclick="closeModal('confirmModal')">&times;</button>
      </div>
      <div class="modal-body">
        <p id="confirmMessage">Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n thá»±c hiá»‡n hÃ nh Ä‘á»™ng nÃ y?</p>
        <div class="form-actions">
          <button type="button" class="btn-cancel" onclick="closeModal('confirmModal')">Há»§y</button>
          <button type="button" class="btn-danger" id="confirmBtn">XÃ¡c nháº­n</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast Notification -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  <script>
    // Firebase config - same as firebase-sync.js
    const firebaseConfig = {
      apiKey: "AIzaSyCMow1S51XanUxwyLbwt714Wgqjue7-2Mk",
      authDomain: "one-piece-bounty-game.firebaseapp.com",
      databaseURL: "https://one-piece-bounty-game-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "one-piece-bounty-game",
      storageBucket: "one-piece-bounty-game.firebasestorage.app",
      messagingSenderId: "410745987244",
      appId: "1:410745987244:web:b1053716c882ebae77bf09"
    };
    
    // Initialize Firebase if not already
    if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
    }
  </script>
  <script src="js/admin.js"></script>
</body>
</html>
